<!DOCTYPE html>
<html>
<title>W3.CSS Template</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
html,body,h1,h2,h3,h4,h5 {font-family: "Raleway", sans-serif}
</style>

<!-- ============================================== -->
<style type="text/css">
	#container {
		max-width: 1500px;
		height: 850px;
		margin: auto;
		background-color: #E5E5E5;
	}

	.hidden {
		display: none;
		visibility: hidden;
	}    
	/*---------------------*/
	/* for switch box */
	/* The switch - the box around the slider */
	.switch {
	  position: relative;
	  display: inline-block;
	  width: 60px;
	  height: 34px;
	}

	/* Hide default HTML checkbox */
	.switch input {
	  opacity: 0;
	  width: 0;
	  height: 0;
	}

	/* The slider */
	.slider {
	  position: absolute;
	  cursor: pointer;
	  top: 0;
	  left: 0;
	  right: 0;
	  bottom: 0;
	  background-color: #ccc;
	  -webkit-transition: .4s;
	  transition: .4s;
	}

	.slider:before {
	  position: absolute;
	  content: "";
	  height: 26px;
	  width: 26px;
	  left: 4px;
	  bottom: 4px;
	  background-color: white;
	  -webkit-transition: .4s;
	  transition: .4s;
	}

	input:checked + .slider {
	  background-color: #2196F3;
	}

	input:focus + .slider {
	  box-shadow: 0 0 1px #2196F3;
	}

	input:checked + .slider:before {
	  -webkit-transform: translateX(26px);
	  -ms-transform: translateX(26px);
	  transform: translateX(26px);
	}

	/* Rounded sliders */
	.slider.round {
	  border-radius: 34px;
	}

	.slider.round:before {
	  border-radius: 50%;
	}
	/*---------------------*/
</style>

<!-- Imports -->
{% load static %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
{% load static %}
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- START SIGMA IMPORTS -->
{% load static %}
<script src="{% static "sigma.js/src/sigma.core.js" %}"></script>
{% load static %}
<script src="{% static "sigma.js/src/conrad.js" %}" ></script>
{% load static %}
<script src="{% static "sigma.js/src/utils/sigma.utils.js" %}" ></script>
{% load static %}
<script src="{% static "sigma.js/src/utils/sigma.polyfills.js" %}" ></script>
{% load static %}
<script src="{% static "sigma.js/src/sigma.settings.js" %}" ></script>
{% load static %}
<script src="{% static "sigma.js/src/classes/sigma.classes.dispatcher.js" %}" ></script>
{% load static %}
<script src="{% static "sigma.js/src/classes/sigma.classes.configurable.js" %}" ></script>
{% load static %}
<script src="{% static "sigma.js/src/classes/sigma.classes.graph.js" %}" ></script>
{% load static %}
<script src="{% static "sigma.js/src/classes/sigma.classes.camera.js" %}" ></script>
{% load static %}
<script src="{% static "sigma.js/src/classes/sigma.classes.quad.js" %}" ></script>
{% load static %}
<script src="{% static "sigma.js/src/classes/sigma.classes.edgequad.js" %}" ></script>
<script src="{% static "sigma.js/src/captors/sigma.captors.mouse.js" %}" ></script>
<script src="{% static "sigma.js/src/captors/sigma.captors.touch.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/sigma.renderers.canvas.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/sigma.renderers.webgl.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/sigma.renderers.svg.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/sigma.renderers.def.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/webgl/sigma.webgl.nodes.def.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/webgl/sigma.webgl.nodes.fast.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/webgl/sigma.webgl.edges.def.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/webgl/sigma.webgl.edges.fast.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/webgl/sigma.webgl.edges.arrow.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/canvas/sigma.canvas.labels.def.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/canvas/sigma.canvas.hovers.def.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/canvas/sigma.canvas.nodes.def.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/canvas/sigma.canvas.edges.def.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/canvas/sigma.canvas.edges.curve.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/canvas/sigma.canvas.edges.arrow.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/canvas/sigma.canvas.edges.curvedArrow.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/canvas/sigma.canvas.edgehovers.def.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/canvas/sigma.canvas.edgehovers.curve.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/canvas/sigma.canvas.edgehovers.arrow.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/canvas/sigma.canvas.edgehovers.curvedArrow.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/canvas/sigma.canvas.extremities.def.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/svg/sigma.svg.utils.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/svg/sigma.svg.nodes.def.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/svg/sigma.svg.edges.def.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/svg/sigma.svg.edges.curve.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/svg/sigma.svg.labels.def.js" %}" ></script>
<script src="{% static "sigma.js/src/renderers/svg/sigma.svg.hovers.def.js" %}" ></script>
<script src="{% static "sigma.js/src/middlewares/sigma.middlewares.rescale.js" %}" ></script>
<script src="{% static "sigma.js/src/middlewares/sigma.middlewares.copy.js" %}" ></script>
<script src="{% static "sigma.js/src/misc/sigma.misc.animation.js" %}" ></script>
<script src="{% static "sigma.js/src/misc/sigma.misc.bindEvents.js" %}" ></script>
<script src="{% static "sigma.js/src/misc/sigma.misc.bindDOMEvents.js" %}" ></script>
<script src="{% static "sigma.js/src/misc/sigma.misc.drawHovers.js" %}" ></script>
<script src="{% static "sigma.js/plugins/sigma.parsers.json/sigma.parsers.json.js" %}" ></script>
<script src="{% static "sigma.js/build/plugins/sigma.layout.forceAtlas2.min.js" %}" ></script>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

<!-- ============================================== -->
<body class="w3-light-grey">

<!-- Top container -->
<div class="w3-bar w3-top w3-black w3-large" style="z-index:4">
  <span class="w3-bar-item w3-left">Dataset Discovery Demo</span>
  <span class="w3-middle">
    <a href="#" class="w3-bar-item w3-button w3-padding w3-blue"><i class="fa fa-search fa-fw"></i>Main Page</a>
    <!-- <a href="#" class="w3-bar-item w3-button w3-padding"><i class="fa fa-eye fa-fw"></i>Table View</a>
    <a href="#" class="w3-bar-item w3-button w3-padding"><i class="fa fa-eye fa-fw"></i>Node View</a>
     -->
  </span>

</div>

<!-- Sidebar/menu -->
<!-- <nav class="w3-sidebar w3-collapse w3-white w3-animate-left" style="z-index:3;width:150px;" id="mySidebar"><br>
  <div class="w3-container">
    <h5>Dashboard</h5>
  </div>
  <div class="w3-bar-block">
    <a href="#" class="w3-bar-item w3-button w3-padding w3-blue"><i class="fa fa-search fa-fw"></i>Main Page</a>
    <a href="#" class="w3-bar-item w3-button w3-padding"><i class="fa fa-eye fa-fw"></i>Table View</a>
    <a href="#" class="w3-bar-item w3-button w3-padding"><i class="fa fa-eye fa-fw"></i>Node View</a>
    <br>
  </div>
</nav> -->


<!-- Overlay effect when opening sidebar on small screens -->
<!-- <div class="w3-overlay w3-hide-large w3-animate-opacity" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay"></div>
 -->
<!-- !PAGE CONTENT! -->
<div class="w3-main">

  <!-- ================================ -->
  <!-- Keyword Search Box -->
  <header class="w3-container" style="padding-top:22px">
    <h5><b><i class="fa"></i> Keyword Search</b></h5>
  </header>

  <div class="w3-row-padding w3-margin-bottom">
      <div class="w3-container w3-blue w3-padding-16">
        <div class="w3-left">
        	<input id="keywordsSearchForm" type="text" name="keywords" value=" "/>
			<button id="showgraph" onclick="showgraph()">Search</button>
			<button id="expand" disabled onclick="expand()">Expand</button>
			<button id="strain" disabled onclick="train()">start training</button>
			<button id="retrain" disabled onclick="retrain()">Retrain</button>
        </div>
        <!-- <div class="w3-right">
          <button onclick="expand()">Expand</button>
			<button onclick="train()">Retrain</button>
        </div> -->
        <!-- <div class="w3-clear"></div> -->
        <!-- <h4>Messages</h4> -->
      </div>    
  </div>


  <!-- DashBoard -->
  <!-- <header class="w3-container" style="padding-top:22px">
    <h5><b><i class="fa fa-dashboard"></i> Dashboard</b></h5>
  </header>

  <div class="w3-row-padding w3-margin-bottom">
      <div class="w3-container w3-blue w3-padding-16">
        <div class="w3-left"><i class="fa fa-comment w3-xxxlarge"></i></div>
        <div class="w3-right">
          <h3>52</h3>
        </div>
        <div class="w3-clear"></div>
        <h4>Messages</h4>
      </div>    
  </div> -->

  <!-- ================================ -->
  <!-- Performance Bar -->
  <hr>
  <div class="w3-container">
    <h5>Performance Evaluation</h5>
    <p>Training Accuracy</p>
    <div  class="w3-grey">
      <div  id = "training_acc" class="w3-container w3-center w3-padding w3-green" style="width:0%">0%</div>
    </div>
  </div>

  <!-- ================================ -->
  <!-- Middle Content -->
  <div class="w3-panel">
    <div class="w3-row-padding" style="margin:0 -16px">
      <!-- _________________________ -->
      <!-- Graph View -->
      <div class="w3-half" >
        <h5>Graph</h5>
  	    <div  class="w3-col" id="container-div"  >
      	    <div id="container" style="max-height: 400px"></div>
      	    <!-- TODO: Zoom In, Zoom Out (Table, node view) -->
			<!-- <div id="ZoomDiv" class="col-md-6 col-md-offset-5">
				<button  id="zoomIn" class="btn btn-default"><span class="glyphicon glyphicon-plus"></span></button>
				<button  id="zoomOut" class="btn btn-default"><span class="glyphicon glyphicon-minus"></span></button>
				<button  id="zoomDef" class="btn btn-default"><span class="glyphicon glyphicon-resize-full"></span></button>
			</div> -->
    		</div>
        </div>
      <!-- _________________________ -->
      <!-- Node information and Labeling -->
      <div class="w3-half" >
        <h5>New attributes to label</h5>
        <div id= "attr_for_label" style="max-height: 400px; overflow-x:auto; overflow-y:auto; " >
        <table class="w3-table w3-striped w3-white" id="table_attr_for_label" style="max-height: 400px">
          <tr>
          	<th>R/NotR</th>
          	<th>ID</th>
          	<th>Description</th>
      	  </tr>
        </table>
        </div>
      </div>
    </div>
  </div>
  
  <!-- _________________________ -->
  <!-- Table Fusion and Attribute Fusion -->
      
  <div class="w3-container">
    <h5>Tables List</h5>
    <!-- <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container-fluid">
        <div>
          <div class="collapse navbar-collapse" id="myNavbar">
          <ul class="nav navbar-nav">
            <li><a href="#table_fusion_tableView">Table View</a></li>
            <li><a href="#table_fusion_attributeView">Attribute View</a></li>
            
          </ul>
          </div>
        </div>
      </div>
    </nav> -->
  

    <div id="table_fusion_tableView" class="container-fluid">
       <table class="w3-table w3-striped w3-white" id="table_list" style="max-height: 400px">
          <tr>
            <th>Table name</th>
            
          </tr>
        </table>
    </div>

    <h5>Attribute Fusion</h5>
    <div id="table_fusion_attributeView" class="container-fluid">
       <table class="w3-table w3-striped w3-white" id="attribute_fusion" style="max-height: 400px">
          <tr>
            <!-- <th>Table name</th> -->
            
          </tr>
        </table>
    </div>
  </div>

    
   
  <!-- </div> -->

<!-- 
  <hr>
  <div class="w3-container">
    <h5>Recent Users</h5>
    <ul class="w3-ul w3-card-4 w3-white">
      <li class="w3-padding-16">
        <img src="/w3images/avatar2.png" class="w3-left w3-circle w3-margin-right" style="width:35px">
        <span class="w3-xlarge">Mike</span><br>
      </li>
      <li class="w3-padding-16">
        <img src="/w3images/avatar5.png" class="w3-left w3-circle w3-margin-right" style="width:35px">
        <span class="w3-xlarge">Jill</span><br>
      </li>
      <li class="w3-padding-16">
        <img src="/w3images/avatar6.png" class="w3-left w3-circle w3-margin-right" style="width:35px">
        <span class="w3-xlarge">Jane</span><br>
      </li>
    </ul>
  </div>
  <hr>

  <div class="w3-container">
    <h5>Recent Comments</h5>
    <div class="w3-row">
      <div class="w3-col m2 text-center">
        <img class="w3-circle" src="/w3images/avatar3.png" style="width:96px;height:96px">
      </div>
      <div class="w3-col m10 w3-container">
        <h4>John <span class="w3-opacity w3-medium">Sep 29, 2014, 9:12 PM</span></h4>
        <p>Keep up the GREAT work! I am cheering for you!! Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p><br>
      </div>
    </div>

    <div class="w3-row">
      <div class="w3-col m2 text-center">
        <img class="w3-circle" src="/w3images/avatar1.png" style="width:96px;height:96px">
      </div>
      <div class="w3-col m10 w3-container">
        <h4>Bo <span class="w3-opacity w3-medium">Sep 28, 2014, 10:15 PM</span></h4>
        <p>Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p><br>
      </div>
    </div>
  </div>
  <br>
  <div class="w3-container w3-dark-grey w3-padding-32">
    <div class="w3-row">
      <div class="w3-container w3-third">
        <h5 class="w3-bottombar w3-border-green">Demographic</h5>
        <p>Language</p>
        <p>Country</p>
        <p>City</p>
      </div>
      <div class="w3-container w3-third">
        <h5 class="w3-bottombar w3-border-red">System</h5>
        <p>Browser</p>
        <p>OS</p>
        <p>More</p>
      </div>
      <div class="w3-container w3-third">
        <h5 class="w3-bottombar w3-border-orange">Target</h5>
        <p>Users</p>
        <p>Active</p>
        <p>Geo</p>
        <p>Interests</p>
      </div>
    </div>
  </div>
 -->
  <!-- Footer -->
  <!-- <footer class="w3-container w3-padding-16 w3-light-grey">
    <h4>FOOTER</h4>
    <p>Powered by <a href="https://www.w3schools.com/w3css/default.asp" target="_blank">w3.css</a></p>
  </footer> -->

  <!-- End page content -->
</div>

<script>
// Get the Sidebar
var mySidebar = document.getElementById("mySidebar");

// Get the DIV with overlay effect
var overlayBg = document.getElementById("myOverlay");

// Toggle between showing and hiding the sidebar, and add overlay effect
function w3_open() {
  if (mySidebar.style.display === 'block') {
    mySidebar.style.display = 'none';
    overlayBg.style.display = "none";
  } else {
    mySidebar.style.display = 'block';
    overlayBg.style.display = "block";
  }
}

// Close the sidebar with the close button
function w3_close() {
  mySidebar.style.display = "none";
  overlayBg.style.display = "none";
}

</script>

<!-- ====================================== -->
<!-- ====================================== -->

<script type="text/javascript">
$('#myModal').modal({show:false});



{% block jquery %}
 function showgraph()
 {

	 $.ajax({ 
	 	type:"POST",
	 	url: "../search/api/graphdata",
	 	data: { keywords: document.getElementById("keywordsSearchForm").value}, 

	 	success: function(returneddata){
	 		console.log("Success .... ")
	 		console.log(returneddata)
	 		gdata = returneddata;

	 		// clear the graph to load the new one
	 		var g = document.getElementById('container'); //document.querySelector('#graph');
		    var p = g.parentNode;
		    p.removeChild(g);
		    var c = document.createElement('div');
		    c.setAttribute('id', 'container');
        c.setAttribute('style', 'max-height: 400px');
		    p.appendChild(c);

	 		s = new sigma({
			  graph: returneddata,
			  container: 'container',
				renderer: {
					container: document.getElementById('container'),
					type: 'canvas'
				},
				settings: {
					minNodeSize: 1,
					maxNodeSize: 14,
					minEdgeSize:0.1,
					maxEdgeSize:0.5,
					verbose:true,
					labelThreshold:10,  
					defaultEdgeType:"curve",
					defaultLabelColor: "#000",
					defaultLabelSize: 14,
					defaultLabelBGColor: "#ddd",
					defaultHoverLabelBGColor: "#002147",
					defaultLabelHoverColor: "#fff",
				    	zoomMin: 0.05,
				    	zoomMax: 1,
				      glyphScale: 0.7,
				      glyphFillColor: '#666',
				      glyphTextColor: 'white',
				      glyphStrokeColor: 'transparent',
				      glyphFont: 'FontAwesome',
				      glyphFontStyle: 'normal',
				      glyphTextThreshold: 6,
				      glyphThreshold: 3	    	

				}
			});

	 		s.refresh();

	 		var i,
                    nodes = s.graph.nodes(),
                    len = nodes.length;

            for (i = 0; i < len; i++) {
                nodes[i].x = Math.random(); //*nodes[i].id;
                nodes[i].y = Math.random();//*(nodes[i].id/2);
                nodes[i].size = s.graph.degree(nodes[i].id);
                nodes[i].color = nodes[i].center ? '#333' : '#666';
                console.log(nodes[i].x + ',' + nodes[i].y);
            }

            // Refresh the display:
            s.refresh();

            // ForceAtlas Layout
            // s.startForceAtlas2({startingIterations : 0, iterationsPerRender  : 0});
            // window.setTimeout(function() {s.killForceAtlas2()}, 10000);


	 	},
	 	error: function(error_data){
	 		console.log("error")
	 		console.log(error_data)
	 	}
	 })

	 document.getElementById("expand").disabled = false;
	 document.getElementById("strain").disabled = false;
	 console.log("gdata After ...");
	 
 }


 function expand()
 {

	 $.ajax({
	 	type:"POST",
	 	url: "../search/api/expand",
	 	//data: { keywords: document.getElementById("keywordsSearchForm").value}, 

	 	success: function(returneddata){
	 		console.log("expand Success .... ")
	 		console.log(returneddata)
	 		gdata = returneddata;

	 		// clear the graph to load the new one
	 		var g = document.getElementById('container'); //document.querySelector('#graph');
		    var p = g.parentNode;
		    p.removeChild(g);
		    var c = document.createElement('div');
		    c.setAttribute('id', 'container');
        c.setAttribute('style', 'max-height: 400px');
		    p.appendChild(c);

	 		s = new sigma({
			  graph: returneddata,
			  container: 'container',
				renderer: {
					container: document.getElementById('container'),
					type: 'canvas'
				},
				settings: {
					minNodeSize: 1,
					maxNodeSize: 14,
					minEdgeSize:0.1,
					maxEdgeSize:0.5,
					verbose:true,
					labelThreshold:10,  
					defaultEdgeType:"curve",
					defaultLabelColor: "#000",
					defaultLabelSize: 14,
					defaultLabelBGColor: "#ddd",
					defaultHoverLabelBGColor: "#002147",
					defaultLabelHoverColor: "#fff",
				    	zoomMin: 0.05,
				    	zoomMax: 1,
				      glyphScale: 0.7,
				      glyphFillColor: '#666',
				      glyphTextColor: 'white',
				      glyphStrokeColor: 'transparent',
				      glyphFont: 'FontAwesome',
				      glyphFontStyle: 'normal',
				      glyphTextThreshold: 6,
				      glyphThreshold: 3	    	

				}
			});

	 		s.refresh();

	 		var i,
                    nodes = s.graph.nodes(),
                    len = nodes.length;

            for (i = 0; i < len; i++) {
                nodes[i].x = Math.random(); //*nodes[i].id;
                nodes[i].y = Math.random();//*(nodes[i].id/2);

                nodes[i].size = s.graph.degree(nodes[i].id);
                
            	if (nodes[i].attributes.fieldname == nodes[i].attributes.tablename ){
                	nodes[i].color = '#F93F17' ;
            	}
            	else {
            		nodes[i].color = '#666';
            	}
                console.log(nodes[i].istable );
                console.log(nodes[i].attributes.fieldname);
                console.log(nodes[i].attributes.tablename);
            }

            // Refresh the display:
            s.refresh();

            // ForceAtlas Layout
            // s.startForceAtlas2({startingIterations : 0, iterationsPerRender  : 0});
            // window.setTimeout(function() {s.killForceAtlas2()}, 10000);


	 	},
	 	error: function(error_data){
	 		console.log("error")
	 		console.log(error_data)
	 	}
	 })

	 console.log("gdata After ...");
	 
 }

 function train()
 {

	 $.ajax({
	 	type:"POST",
	 	url: "../search/api/train",
	 	data: {relevence: ''}, 

	 	success: function(returneddata){
	 		console.log("expand Success .... ")
	 		console.log(returneddata)
	 		gdata = returneddata['graph'];
	 		nids_for_label = returneddata['nids_for_label'];
      training_acc = returneddata['training_acc'];
	 		console.log(nids_for_label)
      console.log(training_acc)

	 		// clear the graph to load the new one
	 		var g = document.getElementById('container'); //document.querySelector('#graph');
		    var p = g.parentNode;
		    p.removeChild(g);
		    var c = document.createElement('div');
		    c.setAttribute('id', 'container');
        c.setAttribute('style', 'max-height: 400px');
		    p.appendChild(c);

	 		s = new sigma({
			  graph: gdata,
			  container: 'container',
				renderer: {
					container: document.getElementById('container'),
					type: 'canvas'
				},
				settings: {
					minNodeSize: 1,
					maxNodeSize: 14,
					minEdgeSize:0.1,
					maxEdgeSize:0.5,
					verbose:true,
					labelThreshold:10,  
					defaultEdgeType:"curve",
					defaultLabelColor: "#000",
					defaultLabelSize: 14,
					defaultLabelBGColor: "#ddd",
					defaultHoverLabelBGColor: "#002147",
					defaultLabelHoverColor: "#fff",
				    	zoomMin: 0.05,
				    	zoomMax: 1,
				      glyphScale: 0.7,
				      glyphFillColor: '#666',
				      glyphTextColor: 'white',
				      glyphStrokeColor: 'transparent',
				      glyphFont: 'FontAwesome',
				      glyphFontStyle: 'normal',
				      glyphTextThreshold: 6,
				      glyphThreshold: 3	    	

				}
			});

	 		s.refresh();

	 		var i,
                    nodes = s.graph.nodes(),
                    len = nodes.length;

            for (i = 0; i < len; i++) {
                nodes[i].x = Math.random(); //*nodes[i].id;
                nodes[i].y = Math.random();//*(nodes[i].id/2);

                nodes[i].size = s.graph.degree(nodes[i].id);
                
            	if (nodes[i].attributes.fieldname == nodes[i].attributes.tablename ){
                	nodes[i].color = '#F93F17' ;
            	}
            	else {
            		nodes[i].color = '#666';
            	}
                // console.log(nodes[i].istable );
                // console.log(nodes[i].attributes.fieldname);
                // console.log(nodes[i].attributes.tablename);
            }

            // Refresh the display:
            s.refresh();

            // ForceAtlas Layout
            // s.startForceAtlas2({startingIterations : 0, iterationsPerRender  : 0});
            // window.setTimeout(function() {s.killForceAtlas2()}, 10000);

            // ================
            // Update the table of attributes
            console.log("Update the table");

            var nids_for_label_obj = nids_for_label //JSON.parse(nids_for_label)
            // display nodes that need to be labeled
            var g = document.getElementById('table_attr_for_label'); //document.querySelector('#graph');
    		    var p = g.parentNode;
    		    p.removeChild(g);
    		    var table = document.createElement('table');
    		    table.setAttribute('id', 'table_attr_for_label');
    		    table.setAttribute('class', 'w3-table w3-striped w3-white');
            table.setAttribute('style', 'max-height: 400px');
            

      			var header = table.createTHead();
      			var row = header.insertRow(0);
      			var cell0 = row.insertCell(0);
      			cell0.innerHTML = "<b>notRel/Rel</b>";
      			var cell1 = row.insertCell(1);
      			cell1.innerHTML = "<b>Attribute</b>";
      			var cell2 = row.insertCell(2);
      			cell2.innerHTML = "<b>Description</b>";

      			nids = Object.keys(nids_for_label_obj)
      		    size = nids.length;
      		    for (i=0; i<size; i++){
      		    	nid = nids[i];
      		    	nid_data = nids_for_label_obj[nid]
      		    	nid_name = nid_data.field_name
      		    	nid_source_name = nid_data.source_name

      		    	var label = document.createElement('label');
      		    	label.setAttribute('class', 'switch');
      		    	var select = document.createElement('input');
      		    	select.setAttribute('type', 'checkbox');
      		    	select.setAttribute('id', nid);
      		    	var span = document.createElement('span');
      		    	span.setAttribute('class', 'slider');

      		    	label.appendChild(select);
      		    	label.appendChild(span);

      		    	var row = table.insertRow(i+1);
      				cell0 = row.insertCell(0);
      				cell0.appendChild(label);
      				cell1 = row.insertCell(1);
      				cell1.innerHTML = nid_name;
      				cell2 = row.insertCell(2);
      				cell2.innerHTML = nid_source_name;
      			
      		    }

      		    // append the table to the parent 
      		    p.appendChild(table);


        // ========================
        // Update the performance bar

        console.log('Update the Performace Bar');
        
        var training_bar = document.getElementById('training_acc'); 
        
        console.log(training_bar);
        
        var training_bar_p = training_bar.parentNode;
        training_bar_p.removeChild(training_bar);
        
        console.log(training_bar_p);
        

        training_acc = training_acc * 100;
        training_acc = training_acc.toFixed(2);
        var item = document.createElement('div');
        item.setAttribute('id', 'training_acc');
        item.setAttribute('style', 'width:'+training_acc+'%');
        item.setAttribute('class', 'w3-container w3-center w3-padding w3-green');
        item.setAttribute('class', 'w3-container w3-center w3-padding w3-green');
        item.innerHTML = training_acc + '%';
        training_bar_p.appendChild(item);

        console.log(training_bar_p);
		    


	 	},
	 	error: function(error_data){
	 		console.log("error")
	 		console.log(error_data)
	 	}
	 })
		
	 document.getElementById("strain").disabled = true;
	 document.getElementById("retrain").disabled = false;
	 console.log("gdata After ...");
	 
 }

 function retrain()
 {
    // ===============
    // Get the labeled nodes 
    var relevent = '';
    var notRelvent = '';

    var table = document.getElementById("table_attr_for_label");
    var input = table.getElementsByTagName( 'input' );
            for ( var z = 0; z < input.length; z++ ) {
              console.log('')
              console.log('')
              console.log('Get selected values here ...')
                
                console.log( input[z].id );
                console.log( input[z].value );
                console.log(input[z].checked);
              if (input[z].checked){
                relevent = relevent + input[z].id + ',';
              }
              else {
                notRelvent = notRelvent + input[z].id + ',';
              }
            }


    console.log('Relevent: ');
    console.log(relevent);
    console.log('notRelvent: ');
    console.log(notRelvent);
    // ===============
    // Retrain and retreive the updated graph
	 
   var param = {relevence: relevent+'notRelvent,'+ notRelvent};
   $.ajax({
	 	type:"POST",
	 	url: "../search/api/train",
	 	data:  param, 
    dataType: "json",

	 	success: function(returneddata){
	 		console.log("expand Success .... ")
	 		console.log(returneddata)
	 		gdata = returneddata['graph'];
	 		nids_for_label = returneddata['nids_for_label'];
	 		training_acc = returneddata['training_acc'];
      tables = returneddata['tables'];
      console.log(nids_for_label);
      console.log(training_acc);
      console.log(tables);

	 		// ========================
      // clear the graph to load the new one
	 		var g = document.getElementById('container'); //document.querySelector('#graph');
		    var p = g.parentNode;
		    p.removeChild(g);
		    var c = document.createElement('div');
		    c.setAttribute('id', 'container');
        c.setAttribute('style', 'max-height: 400px');
		    p.appendChild(c);

	 		s = new sigma({
			  graph: gdata,
			  container: 'container',
				renderer: {
					container: document.getElementById('container'),
					type: 'canvas'
				},
				settings: {
					minNodeSize: 1,
					maxNodeSize: 14,
					minEdgeSize:0.1,
					maxEdgeSize:0.5,
					verbose:true,
					labelThreshold:10,  
					defaultEdgeType:"curve",
					defaultLabelColor: "#000",
					defaultLabelSize: 14,
					defaultLabelBGColor: "#ddd",
					defaultHoverLabelBGColor: "#002147",
					defaultLabelHoverColor: "#fff",
				    	zoomMin: 0.05,
				    	zoomMax: 1,
				      glyphScale: 0.7,
				      glyphFillColor: '#666',
				      glyphTextColor: 'white',
				      glyphStrokeColor: 'transparent',
				      glyphFont: 'FontAwesome',
				      glyphFontStyle: 'normal',
				      glyphTextThreshold: 6,
				      glyphThreshold: 3	    	

				}
			});

	 		s.refresh();

	 		var i,
                    nodes = s.graph.nodes(),
                    len = nodes.length;

            for (i = 0; i < len; i++) {
                nodes[i].x = Math.random(); //*nodes[i].id;
                nodes[i].y = Math.random();//*(nodes[i].id/2);

                nodes[i].size = s.graph.degree(nodes[i].id);
                
            	if (nodes[i].attributes.fieldname == nodes[i].attributes.tablename ){
                	nodes[i].color = '#F93F17' ;
            	}
            	else {
            		nodes[i].color = '#666';
            	}
                // console.log(nodes[i].istable );
                // console.log(nodes[i].attributes.fieldname);
                // console.log(nodes[i].attributes.tablename);
            }

            // Refresh the display:
            s.refresh();

            // ForceAtlas Layout
            // s.startForceAtlas2({startingIterations : 0, iterationsPerRender  : 0});
            // window.setTimeout(function() {s.killForceAtlas2()}, 10000);

            // ========================
            // Update the table of attributes

            console.log("Update the table");

            var nids_for_label_obj = nids_for_label //JSON.parse(nids_for_label)
            // display nodes that need to be labeled
            var g = document.getElementById('table_attr_for_label'); //document.querySelector('#graph');
    		    var p = g.parentNode;
    		    p.removeChild(g);
    		    var table = document.createElement('table');
    		    table.setAttribute('id', 'table_attr_for_label');
    		    table.setAttribute('class', 'w3-table w3-striped w3-white');
            table.setAttribute('style', 'max-height: 400px');

      			var header = table.createTHead();
      			var row = header.insertRow(0);
      			var cell0 = row.insertCell(0);
      			cell0.innerHTML = "<b>notRel/Rel</b>";
      			var cell1 = row.insertCell(1);
      			cell1.innerHTML = "<b>Attribute</b>";
      			var cell2 = row.insertCell(2);
      			cell2.innerHTML = "<b>Description</b>";

      			nids = Object.keys(nids_for_label_obj)
    		    size = nids.length;
    		    for (i=0; i<size; i++){
    		    	nid = nids[i];
    		    	nid_data = nids_for_label_obj[nid]
    		    	nid_name = nid_data.field_name
    		    	nid_source_name = nid_data.source_name

    		    	var label = document.createElement('label');
    		    	label.setAttribute('class', 'switch');
    		    	var select = document.createElement('input');
    		    	select.setAttribute('type', 'checkbox');
    		    	select.setAttribute('id', nid);
    		    	var span = document.createElement('span');
    		    	span.setAttribute('class', 'slider');

    		    	label.appendChild(select);
    		    	label.appendChild(span);

    		    	var row = table.insertRow(i+1);
      				cell0 = row.insertCell(0);
      				cell0.appendChild(label);
      				cell1 = row.insertCell(1);
      				cell1.innerHTML = nid_name;
      				cell2 = row.insertCell(2);
      				cell2.innerHTML = nid_source_name;
    			
    		    }

		    // append the table to the parent 
		    p.appendChild(table);

        // ========================
        // Update the performance bar

        console.log('Update the Performace Bar');
        
        var training_bar = document.getElementById('training_acc'); 
        
        console.log(training_bar);
        
        var training_bar_p = training_bar.parentNode;
        training_bar_p.removeChild(training_bar);
        
        console.log(training_bar_p);
        

        training_acc = training_acc * 100;
        training_acc = training_acc.toFixed(2);
        var item = document.createElement('div');
        item.setAttribute('id', 'training_acc');
        item.setAttribute('style', 'width:'+training_acc+'%');
        item.setAttribute('class', 'w3-container w3-center w3-padding w3-green');
        item.setAttribute('class', 'w3-container w3-center w3-padding w3-green');
        item.innerHTML = training_acc + '%';
        training_bar_p.appendChild(item);

        console.log(training_bar_p);

        // ==========================
        // update the table list

        tables_list = tables.split(';');

        var g = document.getElementById('table_list'); //document.querySelector('#graph');
        var p = g.parentNode;
        p.removeChild(g);
        var table = document.createElement('table');
        table.setAttribute('id', 'table_list');
        table.setAttribute('class', 'w3-table w3-striped w3-white');
        table.setAttribute('style', 'max-height: 400px');

        var header = table.createTHead();
        var row = header.insertRow(0);
        var cell0 = row.insertCell(0);
        cell0.innerHTML = "<b>File Name</b>";
        

        size = tables_list.length;
        for (i=0; i<size; i++){
          table_name = tables_list[i];
          var row = table.insertRow(i+1);
          cell0 = row.insertCell(0);
          cell0.innerHTML = table_name;
          
      
        }

        // append the table to the parent 
        p.appendChild(table);

		    


	 	},
	 	error: function(error_data){
	 		console.log("error")
	 		console.log(error_data)
	 	}
	 })

	 console.log("gdata After ...");
	 
 }

 {% endblock %}




s= new sigma({
	container: 'g-container',
	renderer: {
		container: document.getElementById('container'),
		type: 'canvas'
	},
	settings: {
		minNodeSize: 1,
		maxNodeSize: 14,
		minEdgeSize:0.1,
		maxEdgeSize:0.5,
		verbose:true,
		labelThreshold:10,  
		defaultEdgeType:"curve",
		defaultLabelColor: "#000",
		defaultLabelSize: 14,
		defaultLabelBGColor: "#ddd",
		defaultHoverLabelBGColor: "#002147",
		defaultLabelHoverColor: "#fff",
	    	zoomMin: 0.05,
	    	zoomMax: 1,
	      glyphScale: 0.7,
	      glyphFillColor: '#666',
	      glyphTextColor: 'white',
	      glyphStrokeColor: 'transparent',
	      glyphFont: 'FontAwesome',
	      glyphFontStyle: 'normal',
	      glyphTextThreshold: 6,
	      glyphThreshold: 3	    	

	}
});

// sigma.parsers.gexf(
// 	'static/data/Graph1.gexf',
// 	s,
// 	function(s) {
// 	// Initialize the Filter API
// 	filter = sigma.plugins.filter(s);
// 	$.getJSON('static/data/MetaData.json',
// 		function (data){
// 			var icons = {
// 				'books':'\uF02d',
// 				'videos':'\uF03d',
// 				'blog':'\uF0f6',
// 				'topic':'\uF16c',
// 				'techprimer':'\uF0f6'
// 			}
// 			s.graph.nodes().forEach(function (n){
// 				for (key in data[n.id]) {
// 					n.attributes[key]=data[n.id][key];
					
// 				};
// 				n.glyphs = [{
// 					position:'top-left',
// 					content:icons[n.attributes['node type']],
// 				}];
// 			})
// 		updatePane(s.graph, filter);	
// 		}
// 	);
// 	function applyMinDegreeFilter(e) {
// 			var v = e.target.value;
// 			$('#min-degree-val').textContent = v;
// 			filter
// 			.undo('min-degree')
// 			.nodesBy(
// 				function(n, options) {
// 					return this.graph.degree(n.id) >= options.minDegreeVal;
// 				},{
// 					minDegreeVal: +v
// 				},
// 				'min-degree'
// 			)
// 			.apply();
// 	};
// 	function applyMinEdgeFilter(e) {
// 			var v = e.target.value;
// 			$('#min-edge-val').textContent = v;
// 			filter
// 			.undo('min-edge')
// 			.edgesBy(
// 				function(n,options){
// 						return n.weight > options.weight	
					
// 				},{
// 					weight: +v
// 				},
// 				'min-edge'
// 			)
// 			.apply();
// 	};	
// 	function applyTypeFilter(e) {
// 		var c = e.target[e.target.selectedIndex].value,
// 			nids = [];
// 		filter
// 		.undo('node-type')
// 		.nodesBy(
// 			function(n, options) {
// 				if (!c.length || n.attributes[options.property] === c) {
// 					nids.push(n.id);
// 				};
// 				return !c.length || n.attributes[options.property] === c;
// 			},{
// 				property: 'type'
// 			},
// 			'node-type'
// 		)
// 		.apply();

//   	}
//   	function applyCategoryFilter(e) {
// 		var c = e.target[e.target.selectedIndex].value,
// 			nids = [];
// 		filter
// 		.undo('node-category')
// 		.nodesBy(
// 			function(n, options) {
// 				if (n.attributes[options.property] === c) {
// 					nids.push(n.id);
// 				};
// 				return !c.length || n.attributes[options.property] === c;
// 			},{
// 				property: 'category'
// 			},
// 			'node-category'
// 		)
// 		.apply();		
// 		locateNode(nids);
//   	};
//  	function applySearchFilter(e) {

// 		var c = e.target.value,
// 			nids = [];
// 		filter
// 		.undo('node-search')
// 		.nodesBy(
// 			function(n, options) {
// 				if (n.label.toLowerCase().search(c) > -1) {
// 					nids.push(n.id);
// 				};
// 				return n.label.toLowerCase().search(c) > -1;
// 			},
// 			{
// 				property: 'RAWR'
// 			},
// 			'node-search'
// 		)
// 		.apply();
// 		locateNode(nids);
//   	}

//   	$('#min-degree').change(applyMinDegreeFilter);  // for Chrome and FF
//   	$('#min-edge').change(applyMinEdgeFilter); // for IE10+, that sucks  	
//   	$('#node-type').change(applyTypeFilter);	
//   	$('#node-category').change(applyCategoryFilter);
//   	$('#node-search').change(applySearchFilter);	

//  	//s.renderers[0].glyphs();
//  	var Rend = s.renderers[0]
// 	Rend.bind('render',function(e){
// 		Rend.glyphs();
// 	})

// 	s.refresh();

// 	var hash = window.location.hash.replace('#','');
// 	if (hash!='') {locateNode(hash)};

// 	$('#zoomIn').on('click',function(){
// 		console.log(Rend.camera.ratio)
// 		if (Rend.camera.ratio>0.5) {
// 			Rend.camera.ratio =Rend.camera.ratio -0.5;	
// 			s.refresh();
// 		};
		
		
// 	})
// 	$('#zoomOut').on('click',function(){
// 		if (Rend.camera.ratio<10) {
// 			Rend.camera.ratio =Rend.camera.ratio +0.5;
// 			s.refresh();
// 		};	
		
// 	})
// 	$('#zoomDef').on('click',function(){
// 		console.log(Rend.camera.ratio)
// 		Rend.camera.ratio =1;
// 		s.refresh();
// 	})
// });

var conf = {
	animation: {
		node: {
		      duration: 800
		},
		edge: {
			duration: 800
		      },
		center: {
		      duration: 300
		}
	},
	//focusOut: true,
};	
var locate = sigma.plugins.locate(s,conf);
if (!s.settings('autoRescale')) {
	sigma.utils.zoomTo(s.camera, 0, 0, conf.zoomDef);
};

function locateNode (nid) {
	if (nid == '') {
		locate.center(1);
	}
	else {
    		locate.nodes(nid);
	}
};
function humanize(str) {
  return str
      .replace(/^[\s_]+|[\s_]+$/g, '')
      .replace(/[_\s]+/g, ' ')
      .replace(/^[a-z]/, function(m) { return m.toUpperCase(); });
}
function updatePane (graph, filter) {
	// get max degree
	var maxDegree = 0,
		maxEdge =0,
		types = {},
		categories = {};
	// read nodes
	graph.nodes().forEach(function(n) {
			maxDegree = Math.max(maxDegree, graph.degree(n.id));
			types[n.attributes.type] = true;
			if (n.attributes.category){
				categories[n.attributes.category] = true;
			}
			
	});
	graph.edges().forEach(function(n) {
		maxEdge = Math.max(maxEdge, n.weight)
	});

	// min degree
	$('#min-degree')[0].max = maxDegree;
	$('#max-degree-value').html(maxDegree);
	$('#min-edge')[0].max = maxEdge;
	$('#max-edge-value').html(maxEdge);

	// node category
	var nodecategoryElt = $('#node-type');
	Object.keys(types).forEach(function(c) {
			var optionElt = $("<option value="+c+"></option>");
			optionElt.append(humanize(c));
			nodecategoryElt.append(optionElt);
  	});

	var nodecategoryElt = $('#node-category');
	Object.keys(categories).forEach(function(c) {
			var optionElt = $("<option></option>");
			optionElt.append(c);
			nodecategoryElt.append(optionElt);
  	});


	// reset button
	  	$('#reset-btn').on("click", function(e) {
		$('#min-degree').val(0);
		$('#min-degree-val').html('0');
		$('#node-type').selectedIndex = 0;
		$('#node-category').selectedIndex = 0;
		$('#min-edge').val(0);
		$('#min-edge-val').html('0');	
		filter.undo().apply();
	  });


};



s.bind('clickNode', function(e) {
	var adjacentNodes = [],
		adjacentEdges = [];
	adjacentNodes = adjacentNodes.concat(s.graph.adjacentNodes(e.data.node.id));
	adjacentEdges = adjacentEdges.concat(s.graph.adjacentEdges(e.data.node.id));
	var meta  = e.data.node.attributes;
	template = '<hr><label for="sharDis">Share this!</label><input class="form-control" type="text" value="gregroberts.github.io#'+e.data.node.id+'">';
	switch(meta['node type']){
		case 'topic':
			template += '<h3><a href="'+meta.url+'" target="new">'+meta.name+'</a></h3>';
			template +='<b>A StackOverflow Tag with '+meta.size+' questions</b><hr>';	
			template += '<p>'+meta['one liner'];
			template += '<b><a href="'+meta.url+'" target="new">Read More...</a></b>'
			template +='</p><i>(Taken from the StackOverflow wiki page)</i><br>';
			;
		break;
		case 'books':
			template += '<h3><a href="'+meta.url+'" target="new">'+meta.title+'</a></h3>';
			template += '<table><tr><td style="padding-right:10px"><a href="'+meta.url+'" target="new"><img style="diplay:inline" src="https://packtpub.com/'+meta['cover image']+'" height="220" ></img></a></td>';

			template +='<td>'+meta['one liner']+'<br>';
			if (meta.authors != 'NULL') {
				template += ' written by '+meta.authors.replace(',',' and ');
			}
			template +='<br>Page count: </b>'+meta['page count']+'<br>';
			template += '<br>Published:</b> '+meta['publication date']+'<br>';
			template+='</td></tr></table><br>';	
			
		break;
		case 'videos':
			template += '<h3><a href="'+meta.url+'" target="new">'+meta.title+'</a></h3>';
			template += '<table><tr><td style="padding-right:10px"><a href="'+meta.url+'" target="new"><img style="diplay:inline" src="https://packtpub.com/'+meta['cover image']+'" height="220" ></img></a></td>';

			template +='<td>'+meta['one liner']+'<br>';
			if (meta.authors != 'NULL') {
				template += ' written by '+meta.authors.replace(',',' and ');
			}
			template +='<br>Duration: </b>'+meta['page count']+'<br>';
			template += '<br>Published:</b> '+meta['publication date']+'<br>';
			template+='</td></tr></table><br>';	
				console.log(meta);		
			if (meta['on offer']!='') {
				template += '<a target="new" href="https://packtpub.com/add_to_cart/'+meta['on offer']+'"><button class="btn btn-success"><b>Hey! This title is on special offer for Python week!<br> Click here to save 50%</b></button></a>';
			};

		break;
		case 'blog':
			template += '<h3><a href="'+meta.url+'" target="new">'+meta.title+'</a></h3>';
			template += '<b>A Blog written by '+meta.authors.replace(',',' and ')+'<hr>';
			template += '<br>Published:</b> '+meta['publication date']+'<br>';
			template += '<p>'+meta['one liner']+'</p>';
		break;
		case 'techprimer':
			template += '<h3><a href="'+meta.url+'" target="new">'+meta.title+'</a></h3>';
			template += '<b>A Packt Tech Primer<hr>';
			template += '<br>Published:</b> '+meta['publication date']+'<br>';
			template += '<p>'+meta['one liner']+'</p>';
		break;

	};
	var related_topics = '<table class="table table-striped"><thead><th>Related Topic Nodes</th></thead><tbody>';
	var related_titles = '<table class="table table-striped"><tbody>';
	var categorise = {};
	for (var i = adjacentNodes.length - 1; i >= 0; i--) {
		t = adjacentNodes[i];
		if( t.attributes.type=='topic') {
			related_topics += '<tr><td><a class="locate" data-id="'+t.id+'">'+t.label +'</a></td></tr>';
		}
		else {
			if (t.attributes.category in categorise) {
				categorise[t.attributes.category].push([t.id,t.label]);
			} else{
				categorise[t.attributes.category] = [[t.id,t.label]];
			};
			
		}
	};
	for (key in categorise) {
		related_titles +='<tr><th>Related '+key+' Nodes</th></tr>';
		for (var i = categorise[key].length - 1; i >= 0; i--) {
			var j = categorise[key][i];
			related_titles += '<tr><td><a class="locate" data-id="'+j[0]+'">'+j[1] +'</a></td></tr>';	
		};
	};
	related_topics+='</tbody></table>';
	related_titles += '</tbody></table>';
	template += related_titles + related_topics;
	$('#infoPanel').empty().html(template);
	$('.locate').on('click', function(e){
		locateNode($(this).attr('data-id'));
	})
});

$('#layout').on('click',function () {
	var config = {
		linLogMode:true,
		barnesHutOptimize:true,
		alignNodeSiblings :true,
	}
	if (! sigma.layouts.isForceLinkRunning()) {
		sigma.layouts.startForceLink(s,config);
	} else {
		sigma.layouts.stopForceLink(s,config);
	};
})



</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-68657545-1', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>
